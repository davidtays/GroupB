<!DOCTYPE html>
<!-- Author: David Tays 
     Date:  02/18/2018
     Desc:  groupB JavaScript Trivia
	 ***** FOCUS ON ANSWER DECLARATIONS AND TEMPLATE FOR THE RESULTS
	 ***** ALSO, COPY AND PASTE ACTUAL QUESTIONS IN THE PROPER ARRAY PROPERTIES
	 ***** 4/20 
	 ***** FULLY COMMENTED FOR YOUR PLEASURE
	 -->


<html lang="en">
	<head>
				
		<meta charset="UTF-8">
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
		<link rel="stylesheet" type="text/css" href="style/style.css" />
		<link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet"> 
		<script src="knockout-3.4.2.js"></script>
			<meta name="description" content="demonstration">
			<meta name="keywords" content="JavaScript Trivia">
			<meta name="author" content="David Tays">
			<meta name="viewport" content="width=device-width, initial-scale=1.0"> 
		<title>&quot;GroupB/Limitless&quot;</title>
		
		</head>
		<body>
			<!-- Header image background on jumbotron in css-->
			<div class="container-fluid">
				<div class="jumbotron">
					<p><strong>Welcome! Are you ready for some trivia?</strong></p>
				</div>
			</div>
			<main class="container-fluid text-center" style="height:520px" >
				<h1>Javascript Trivia</h1>

				<!-- We need the button bound to an event that makes the first question visible -->
				<button type="button"  style="height:100px;width:200px" data-bind="click: show">Start Quiz</button>
				<br/><br/>
				<p>This quiz will check your knowledege of introduction Javascript techniques and properties.  Once you are finished, we will judge and label you.  Don't be afraid, it's for your own good!</p>
				<br/><br/>
				<!-- The button will make this 'trivia-template' template visible -->
				<div data-bind="visible: show" >
					<div data-bind = "template: {name: 'trivia-template', data: selectedQuestion} "></div>
				</div>
				<p data-bind="text: answers">####</p>
				<br/>	
				<button type="button" data-bind="visible: show, click: submitTrivia">Done(grade it)</button>

				<div data-bind="visible: show" >
					
				</div>
				<div data-bind="visible: show" >
					<p>Your Answers</p>
					<ol data-bind="template: { name: 'yourAnswer-Template', foreach: answers, as: 'answer' }"></ol>
					
					<p>Correct Answers</p>
					<ol data-bind="template: { name: 'correctAnswer-Template', foreach: questions, as: 'question' }"></ol>
					<p data-bind="text: rank"></p>
					<img class="img-responsive center-block" style="height:100px;width:200px" data-bind="attr : {src: earnedBadge}" /> 
				</div>
				
				<br/>			
		  </main>
		  <script type="text/html" id="yourAnswer-Template">
			<li>
				<span data-bind="text: answer"></span>
			</li>
		  </script>
		  <script type="text/html" id="correctAnswer-Template">
			<li>
				<span data-bind="text: answer"></span>
			</li>
		  </script>
		  <script type="text/html" id = "trivia-template">
			<!-- this is the template for the questions and options of answers and the next button -->			
				<p data-bind="text: question">####</p>
				<fieldset>
					<div data-bind="foreach: options" style="height:100px">
						<!--  selection is bound when 'checked' to $root.selectedAnswer, which is:
						at the root of the veiwmodel -->
						<input type="radio" name="optionGroup" data-bind="checked:$root.selectedAnswer, checkedValue:$data">
						<label for="optionGroup" data-bind="text: $data">True</label>
						<br/>
					</div>
					<button type="button" data-bind="click: $root.back">Back</button>
					<button type="button" data-bind="click: $root.next">Submit</button>
					
				</fieldset>
			
		  </script>
		  
		  <script type="text/javascript">
			
			function TriviaViewModel() {
				// Absolutely had to make variable for 'this'.
				// Cannot reach the variables of model using 'this.something'
				// from inside the functions of the model unless calling self.blah
				self = this;
				
				//function updates the qNum property and selectedQuestion
				self.next = function(){	
					var num = self.qNum() + 1;
					// this allows the quiz to go to question 1 if on question 10 when next is clicked
					if(num >= 10){
						num = 9;
						//alert("End of Quiz, go the other way!");
					}
					// update model observables (could be another function)
					// check and submit answer ()
					self.update(num);
				};
				//function updates the qNum property and selectedQuestion
				self.back = function(num){	
					var prevNum = self.qNum();				
					var num = self.qNum() - 1;
					//alert(self.selectedAnswer());
					
					// this allows the quiz to go to question 10 if on question 1 when back is clicked
					if(num < 0){
						num = 0;
						alert("Beginning of Quiz, go the other way!");					
					}
					self.update(num);
				};
				self.update = function(num){
					// update model observables (could be another function)
					if(!self.selectedAnswer() == ""){
						self.answers.splice(self.qNum(), 1, self.selectedAnswer());
					}
					
					self.qNum(num);	
					self.selectedQuestion(self.questions()[self.qNum()]);
					self.selectedAnswer(self.answers()[self.qNum()]);
				}
				
				self.submitTrivia = function(){
					var missed = [];
					var correct = 0;
					var incorrect = 0;
					// check if user left questions unanswered and push unanswered indexes to 'missed' array
					for(x = 0; x <= self.answers().length -1; x++){
						if(self.answers()[x] == ""){
							missed.push(x + 1);
						}
					}
					
					if(missed.length == 0){
						alert("all have been answered");
						//compare question.Answer with answers
						for(i = 0; i < 10; i++){
							if(self.questions()[i].answer == self.answers()[i]){
								correct++;
							}else{
								self.indexOfIncorrect.push(i);
								incorrect++;
							}
							
						}
					} else{
						alert("you missed questions:\n" + missed);
					}
					alert("/ncorrect: " + correct + "\nincorrect: " + incorrect);
					if(correct < 7){
						self.rank("Beginner");
						self.earnedBadge("images/BronzeStar.png");
					}else if(correct >= 7 && correct < 9){
						self.rank("Novice");
						self.earnedBadge("images/SilverStar.png");
					}else{
						self.rank("Expert");
						self.earnedBadge("images/GoldStar.png");
					}
				}


				// This is changed when 'start quiz' is clicked to make the div visible
				self.show = ko.observable(false);

				// array of our questions **NEEDS COPY AND PASTE OF PROPERTIES FROM THE COMMENTED INFORMATION BELOW
				self.questions = ko.observableArray([
					{
					question: '1. The most common thing to do with objects are create them and to set, query, delete, and enumerate their properties?',
					options: ['True','False'],
					answer: 'True'
					},
					{
					question: '2. A property has a name and a ________?',
					options: ['string','value','number'],
					answer: 'value'
					},
					{
					question: '3. Event handlers allow JavaScript code to alter ________?',
					options: ['the behavior of windows','the behavior of documents','all of the above'],
					answer: 'all of the above'
					},
					{
					question: '4. Client-side JavaScript code is embedded within HTML documents in four ways?',
					options: ['True','False'],
					answer: 'True'
					},
					{
					question: '5. Any function that uses the yield keyword is a generator function?',
					options: ['True','False'],
					answer: 'True'
					},
					{
					question: '6. Which of the following is a correctly written function?',
					options: ['Function () []','Function {} ()','Function () {}'],
					answer: 'Function () {}'
					},
					{
					question: '7. A For loop executes a certain block of code provided that a certain expression remains true.',
					options: ['True','False'],
					answer: 'False' //: this describes a While loop
					},
					{
					question: '8. If x = 3, then x === "3" must be true right?',
					options: ['True','False'],
					answer: 'False'//: using "===" means the variables have equal values and types
					},
					{
					question: '9. Which Function with its parameters is written correctly?',
					options: ['Function (parameter1 parameter2 parameter3)','Function (parameter1, parameter2, parameter3)','Function (parameter1; parameter2; parameter3)'],
					answer: 'Function (parameter1, parameter2, parameter3)'
					},
					{
					question: '10. Setting breakpoints allows you to stop your code and examine it for errors before restarting it again.',
					options: ['True','False'],
					answer: 'True'
					}
				]);
				//INITIAL DECLARATIONS
				self.qNum = ko.observable(0);
				self.selectedQuestion = ko.observable(self.questions()[self.qNum()]);
				
				self.answers = ko.observableArray();
				// pre loads array so the user can answer question 2 before answering question 1 and the answer will be at the correct index of 'answers' array
				for(x = 0; x <= 9; x++){
					self.answers.push("");
				}
				self.selectedAnswer = ko.observable(self.answers()[self.qNum()]);
				self.indexOfIncorrect = ko.observableArray();
				self.rank = ko.observable("");
				self.earnedBadge = ko.observable("");				
			};
			// applyBindings has to be called to make the model accessible
			ko.applyBindings(new TriviaViewModel());
			
		  </script>
		</body>
		<footer>
				<h2>Contributors </h2>   <span>Nicole Winters, Natasha Colletta, David Tays, Robert Sharp</span>
		</footer>
		
		
</html>